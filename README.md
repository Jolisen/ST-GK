# Scene-GCN: A Time-Series Prediction method in Complex Monitoring Environments Through Spatial–Temporal Knowledge Graph (ST-KG)
## Requirements
- Ubuntu == 20.04
- tensorflow == 1.15
- scipy
- numpy
- matplotlib
- pandas
- math
## Data
The data files are available in `Scene-GCN-Tensorflow/Scene-GCNdata`. The results for `Scene-GCN-Tensorflow/Scene-GCNdata/3611817550_adj.xlsx` need to be obtained using `Scene-GCN-Tensorflow/Gauss.ipynb`.
## Program operation
1. Gauss03.xlsx is the latitude and longitude data for the monitoring target as raw data. This data can generate 3611817550_adj.xlsx by running Gauss.ipynb, which is used as the adjacency matrix of the Scene-GCN model.

2. 3611817550_Reservoir_water_level.xlsx,3611817550_beach_width.xlsx,3611817550_phreatic_line.xlsx,3611817550_precipitation.xlsx, and 3611817550_feature_matrix_X.xlsx are the input data for the Scene-GCN model, which is organized in SceneGCNcell.py.

3. The Scene-GCN model generates the prediction results by running the Scene-GCN_L2 loss min test_rmse.ipynb file, which includes the predicted values, the true values corresponding to the predicted values, and the result values of the evaluation metrics mentioned in the paper.

4. The compare(A).xlsx and compare(A)cut.xlsx files in Scene-GCN-Tensorflow/data_compare are obtained by running the prediction results generated by the Scene-GCN_L2 loss min test_rmse.ipynb file. The data are Ground Truth,T-GCN,Our Algorithm(Static),Our Algorithm(Dynamic) ,Our Algorithm(Static+Dynamic) of a random column of data, which are intended for in-depth model comparison.
You can select different scheme parameters of Scene-GCN_L2 loss min test_rmse.ipynb to generate different results by yourself and generate your own compare(A).xlsx, as shown in the following code:
```
flags.DEFINE_integer('scheme', 5, 'scheme')

if model_name == 'Scene-GCN'.
    if scheme == 1.
        name = 'add direction dim'
    elif scheme == 2: name = 'add beach_width'
        name = 'add beach_width dim'
    elif scheme == 3: name = 'add Reservoir_width dim'.
        name = 'add Reservoir_water_level dim'
    elif scheme == 4: name = 'add phreatic_water_level dim'
        name = 'add phreatic_line dim'
    elif scheme == 5: name = 'add precipitation dim'
        name = 'add precipitation dim'
    elif scheme == 6: name = 'add dynamic attribute dim'
        name = 'add dynamic attribute dim'
    else: name = 'add direction + dynamic attribute dim'
        name = 'add direction + dynamic attributes dim'
```
        
5. Scene-GCN-Tensorflow/plot.ipynb and Scene-GCN-Tensorflow/plotcut.ipynb are used to plot the results of compare(A).xlsx and compare(A)cut.xlsx described above, which were used to generate Figs. 9-12 in the Results section of the paper.

6. Use this line of code in Scene-GCN_L2 loss min test_rmse.ipynb for resizing this parameter. 
```
flags.DEFINE_integer('gru_units', 100, 'hidden units of gru.')
```
where the epoch has been fixed to 2500, and the values of gru_units were selected from [8,16,32,64,100,128].
![图片1](https://github.com/user-attachments/assets/490edc53-d75f-416b-89b3-931d00a941f0)
* Fig. 8 Comparison of the model’s predicted performance on the test set with different numbers of hidden units.
* Use excel to plot figure 8, which corresponds to the table shown below:
* ![image](https://github.com/user-attachments/assets/76e59359-2a5a-4c36-9f71-eb43c266c6e3)

## Our baselines included:
1. Autoregressive Integrated Moving Average model (ARIMA)
2. Support Vector Regression model (SVR)
3. Gated Recurrent Unit model (GRU)
4. Attention Temporal Graph Convolutional Network for Traffic Forecasting (A3T-GCN)
5. A Temporal Graph Convolutional Network for Traffic Prediction (T-GCN)

The python implementation of the ARIMA/SVR/A3T-GCN model is in the baseline folder; the GRU model and the T-GCN model are in gru.py and tgcn.py, respectively.

